# SOCKS Protocol Version 5

## socks5通信过程
**连接：** 首先socks5代理客户端需要与浏览器建立tcp连接，发送协商报文R1；客户端收到协商报文后，回复协商响应报文A1。
**请求：** 客户端请求访问某网页。

## 报文格式

浏览器与客户端连接报文R1格式：

```
   +----+----------+----------+
   |VER | NMETHODS | METHODS  |
   +----+----------+----------+
   | 1  |    1     | 1 to 255 |
   +----+----------+----------+                               
```

* 此处的ver值是5，表示版本5；
* nmethods的值表示随后的methods有多少个；
* methods表示支持的methods.

****

客户端响应连接报文：

```                   
    +----+--------+
    |VER | METHOD |
    +----+--------+
    | 1  |   1    |
    +----+--------+
```

* 此处的ver值是5，表示版本5；
* method表示在上述请求报文中的选择的一个method。

***

访问web等代理报文：

```                   
        +----+-----+-------+------+----------+----------+
        |VER | CMD |  RSV  | ATYP | DST.ADDR | DST.PORT |
        +----+-----+-------+------+----------+----------+
        | 1  |  1  | X'00' |  1   | Variable |    2     |
        +----+-----+-------+------+----------+----------+
```

响应访问请求报文：

```        
        +----+-----+-------+------+----------+----------+
        |VER | REP |  RSV  | ATYP | BND.ADDR | BND.PORT |
        +----+-----+-------+------+----------+----------+
        | 1  |  1  | X'00' |  1   | Variable |    2     |
        +----+-----+-------+------+----------+----------+        
```

## 

## 参考
1. [RFC1928](https://www.ietf.org/rfc/rfc1928.txt)
2. [科学上网之socks5代理原理](http://www.aichengxu.com/wangluo/9370686.htm)
