# WireShark过滤语法

## 简单语法

* "!"和"not"同义，表示“非”的含义。例如：```!tcp```---排除报文中的tcp报文。
* "&&"和"and"同义，表示“且”的含义。例如：```tcp.port>=1 and tcp.port<=80```---过滤出端口在1～80范围的tcp报文。
* “||”和“or”同义，表示“或”的含义。例如：```http or dns```---过滤出http和dns报文。
* "=="和"eq"同义，表示“等于”的含义。例如：```tcp.port==80```---过滤出80端口的tcp报文。类似的还有“>=”,"<=",">","<"等。

## 应用层过滤

### HTTP过滤
``` http.request.method == "GET"```---过滤出使用http get方法的请求报文。
``` http.request.method == "GET" and http contains "Host" ```---过滤出使用http get方法的请求报文，且该报文含有"Host"。
类似还有"POST"方法等。


## 传输层过滤
### 协议过滤
WireShark支持协议过滤。例如过滤出报文中的TCP协议，输入“tcp”回车即可。类似的还有udp协议，http协议，dns协议等。

### 端口过滤
以tcp端口过滤为例，udp类似。例如：``` tcp.port==80```---过滤出80端口的tcp报文。```tcp.srcport==80```---过滤出源端口是80的tcp报文。类似还有```tcp.dstport==80```等。

### 标志过滤
```tcp.flags.syn==0x02```---过滤出含有syn标志的tcp报文。类似还有```tcp.flags.ack```等。

### 报文过滤
以tcp报文过滤为例，udp类似。例如：```tcp.len>0```---过滤出数据长度大于0的tcp报文。```tcp[20]==60```---过滤出第20字节是60的tcp报文。```tcp[20:3]==88:06:61```---过滤出第20字节是88，第21字节是06，第22字节是61的tcp报文。

## 网络层过滤

### IP过滤
```ip.addr==192.168.1.20```---过滤出192.168.1.20这个IP的设备报文。

### 协议过滤
```icmp```---过滤出ping报文。



## 链路层过滤
### mac过滤
```eth.addr==ac:89:a6:37:7f:11```---过滤出mac地址是ac:89:a6:37:7f:11的报文。类似还有"eth.src"，"eth.dst"等。